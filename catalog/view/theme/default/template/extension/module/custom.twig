{{ header }} 

<div class="page page--cart"> 

	<div class="container page__wrapper cart"> 

		{% if errors %}
			{% for error in errors %}
				<div class="alert alert-warning">{{ error }}</div>
			{% endfor %}
		{% elseif empty %}
			<div class="alert alert-info">{{ empty }}</div>
		{% endif %}

		<div class="page__top">
			<div class="page__breadcrumbs">
				<ul class="breadcrumb">
				{% for breadcrumb in breadcrumbs %} 
					<li><a href="{{ breadcrumb.href }}">{{ breadcrumb.text }}</a></li>
				{% endfor %} 
				</ul>
			</div>
			<div class="page__heading">
				<h1 class="page__heading-title">{{ page_title }}</h1>
			</div>
		</div>

		<main class="page__content">

			{% if cart %}
			<div id="custom-cart">
				{{ cart }}
			</div>
			{% endif %}

			<div class="cart__form">

				<div class="left">
		
					{% if login and not logged %} 
						<div id="custom-login">{{ login }}</div>
					{% endif %} 
		
					{% if customer and not logged %} 
						<div id="custom-customer">{{ customer }}</div>
					{% endif %} 
		
					{% if shipping and shipping != constant('false') %} 
						<div id="custom-shipping">{{ shipping }}</div>
					{% endif %} 
		
					{% if payment %} 
						<div id="custom-payment">{{ payment }}</div>
					{% endif %}	
		
					{% if comment and comment != constant('false') %} 
						<div id="custom-comment">{{ comment }}</div>
					{% endif %} 
		
				</div>
		
				<div class="right cart__totals">
					
					{% if module %} 
						<div id="custom-module">{{ module }}</div>
					{% endif %} 
		
					{% if total %} 
						<div id="custom-total">{{ total }}</div>
					{% endif %} 
		
				</div>
		
			</div>
		
			{% if payment %} 
				{% if text_agree %} 
					<div class="buttons" id="custom-control">
					  <div class="pull-right">{{ text_agree }} 
						{% if (agree) %} 
						<input type="checkbox" name="agree" value="1" checked="checked" />
						{% else %} 
						<input type="checkbox" name="agree" value="1" />
						{% endif %} 
						&nbsp;
						<input type="button" value="{{ button_continue }}" id="button-custom-order" data-loading-text="{{ text_loading }}" class="btn btn-primary" style="display: block!important"/>
					  </div>
					  <div class="clearfix"></div>
					</div>
					{% else %} 
					<div class="buttons">
					  <div class="pull-right">
						<input type="button" value="{{ button_continue }}" id="button-custom-order" data-loading-text="{{ text_loading }}" class="btn btn-primary" style="display: block!important" />
					  </div>
					  <div class="clearfix"></div>
					</div>
				{% endif %} 
			{% endif %}	
		
			{{ content_bottom }}
		
			<div id="custom-confirm" style="display: none;"></div>

		</main>

	</div>
	
</div> 

{{ footer }}

<script>
	$(document).ready(function() {

	$('#button-custom-order').on('click', function(){

		{% if (not logged) %} 

				checkoutCustomer()
					{% if (login is defined and login != constant('false')) %} 
						.then( checkoutLogin )
					{% endif %} 
					{% if (shipping is defined and shipping != constant('false')) %} 
						.then( checkoutShipping )
					{% endif %} 
						.then( checkoutPayment )
					{% if (comment is defined and comment != constant('false')) %} 
						.then( checkoutComment )
					{% endif %} 
						.then( checkoutConfirm )
						.catch( failureCallback );

		{% else %} 

			{% if (shipping is defined and shipping != constant('false')) %} 

				checkoutShipping()
					.then( checkoutPayment )
					{% if (comment is defined and comment != constant('false')) %} 
						.then( checkoutComment )
					{% endif %} 
					.then( checkoutConfirm )
					.catch( failureCallback );

			{% else %} 

				checkoutPayment()
					{% if (comment is defined and comment != constant('false')) %} 
							.then( checkoutComment )
						{% endif %} 
						.then( checkoutConfirm )
						.catch( ailureCallback );


			{% endif %}	

		{% endif %} 

	});

	});
  
</script>